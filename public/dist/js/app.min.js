!function(){"use strict";angular.module("cv",["ui.router","ui.bootstrap","ngAnimate","ngToast","utils","naif.base64"]).run(["$rootScope","$window","$currentUser","$baseUrl","$cvId","$state","ngToast",function(t,e,o,r,l,i,n){e.location.href===r?o?i.go("edit",{},{location:!1}):i.go("home",{},{location:!1}):l&&i.go("view",{},{location:!1}),t.$on("notifyUser",function(t,e){n.create({content:e,timeout:2e3})})}]).config(["$stateProvider","$urlRouterProvider","$animateProvider",function(t,e,o){t.state("home",{url:"/home",templateUrl:"/dist/templates/welcome.html",controller:"AppCtrl"}).state("edit",{url:"/edit",templateUrl:"dist/templates/cv/edit/edit.html",controller:"EditController"}).state("view",{url:"/view",templateUrl:"dist/templates/cv/view.html",controller:["$scope","$cvId",function(t,e){t.cvId=e}]})}]).controller("AppCtrl",["$scope",function(t){t.welcome="CV online for coders"}])}();
!function(){"use strict";angular.module("cv").factory("cvFactory",["$http","$baseUrl","cvStructure","$rootScope","$timeout","$q",function(t,e,i,n,r,a){function u(u,s,o,c){var h=this;this.structure=i[u],this.id=s,this.type=u,this.parent=o,this.loading=!1,this.collapsed=this.structure.collapsed,this.childs={},this.defer=a.defer(),this.loadElement=function(){return h.loading=!0,t.get(e+h.getApi()+"/"+h.id).then(function(t){h.loading=!1,h.defer.resolve(h),h.data=t.data.data,t.data.childs&&h.loadChilds(t.data.childs)}),h.defer.promise},this.loadChilds=function(t){angular.forEach(t,function(t,e){h.childs[e]=[],angular.forEach(t,function(t){h.childs[e].push(i[e].childs?d.create(e,t.id,h):d.createLastChild(e,t.id,h,t))})})},this.update=function(){t.put(e+h.getApi()+"/"+h.id,h.data).then(function(){h.notifyUser(h.getTitle()+" updated")})},this.updateImage=function(i){return function(){r(function(){var n=h.imageToUpload;h.data[i]="data:"+n.filetype+";base64,"+n.base64,t.put(e+h.getApi()+"/"+h.id,h.data).then(function(){h.notifyUser(h.getTitle()+" updated")})},200)}},this.remove=function(){angular.forEach(o.childs[h.type],function(t,e){t===h&&o.childs[h.type].splice(e,1)})},this.destroy=function(){t["delete"](e+h.getApi()+"/"+h.id,h.data).then(function(){h.notifyUser(h.getTitle()+" deleted"),h.remove()})},this.createChild=function(n){var r=i[n].init;angular.forEach(i[n].inherit,function(t,e){r[e]=h.data[t]}),t.post(e+i[n].api+"/",r).then(function(t){h.notifyUser(h.getTitle()+" created"),h.collapsed=!1,h.childs[n].push(d.create(n,t.data.data.id,h))})},this.findChild=function(t,e,i){var n=a.defer();return angular.forEach(h.childs[t],function(t){t.loadingPromise().then(function(){t.data[e]===i&&n.resolve(t)})}),n.promise},this.notifyUser=function(t){n.$emit("notifyUser",t)},this.getApi=function(){return h.structure.api},this.getEditable=function(){return h.structure.editable},this.getTitle=function(){return h.structure.title},this.isOrdered=function(){return h.structure.ordered},this.getChilds=function(){return h.structure.childs},this.canAdd=function(){return h.structure.addableChilds},this.canRemove=function(){return h.structure.removable},this.loadingPromise=function(){return h.defer.promise},this.getValue=function(){return h.data[h.structure.value]},"undefined"==typeof c?this.loadElement():(this.data=c,this.defer.resolve())}var d={create:function(t,e,i){return new u(t,e,i)},createLastChild:function(t,e,i,n){return new u(t,e,i,n)}};return d}])}();
!function(){"use strict";var e=["$scope","cvFactory","$q",function(e,t,n){if(this.init=n.defer(),e.init=this.init,e.id){var i=t.create("cv",e.id,null);e.cv={element:i},this.init.resolve(i.loadingPromise())}else e.element&&this.init.resolve(element.loadingPromise())}],t=function(e){return function(t,n,i,r){r.init.promise.then(function(n){e&&n.findChild(e,"name",i.name).then(function(e){t.element=e,t.init&&t.init.resolve(e.loadingPromise())})})}},n=function(){return function(e,t,n,i){i.init.promise.then(function(t){e.element=t})}};angular.module("cv").directive("cvOnline",function(){return{restrict:"E",transclude:!0,controller:e,scope:{id:"@"},template:"<div ng-transclude></div>"}}),angular.module("cv").directive("cvPicture",function(){return{restrict:"E",require:"^cvOnline",link:n(),scope:!0,template:'<img ng-src="{{element.data.profilepic}}" width="100%">'}}),angular.module("cv").directive("cvHeader",function(){return{restrict:"E",require:"^cvOnline",transclude:!0,scope:{name:"@"},link:t("cvHeader"),template:"{{ element.data.value }}"}}),angular.module("cv").directive("cvSection",function(){return{restrict:"E",require:"^cvOnline",transclude:!0,controller:e,scope:{name:"@"},link:t("section"),template:"<div ng-transclude></div>"}}),angular.module("cv").directive("cvSectionName",function(){return{restrict:"E",require:"^cvSection",link:n(),scope:!0,template:"{{element.data.name}} "}}),angular.module("cv").directive("cvItems",function(){return{restrict:"E",require:"^cvSection",transclude:!0,link:n(),template:"<div ng-repeat=\"item in element.childs['item']\" inject/>"}}),angular.module("cv").directive("cvItemName",function(){return{restrict:"E",require:"^cvItems",template:"{{item.data.name}}"}}),angular.module("cv").directive("cvItemHeader",function(){return{restrict:"E",require:"^cvItems",scope:{name:"@"},controller:["$scope",function(e){e.$parent.item.loadingPromise().then(function(t){t.findChild("itemHeader","name",e.name).then(function(t){e.header=t.data.value})})}],template:"{{header}}"}}),angular.module("cv").directive("cvEntries",function(){return{restrict:"E",require:"^cvItems",transclude:!0,template:"<div ng-repeat=\"entry in item.childs['entry']\" inject/>"}}),angular.module("cv").directive("cvEntry",function(){return{restrict:"E",require:"^cvEntries",template:"{{entry.data.entry}}"}}),angular.module("cv").directive("cvEntryPhotos",function(){return{restrict:"E",require:"^cvEntries",template:'<carousel interval="10000"><slide ng-repeat="slide in entry.childs[\'image\']"><img ng-src="{{slide.data.image}}" style="margin:auto;width:100%"/><div style="background-color:rgba(0,0,0,.6)" class="carousel-caption">{{slide.data.description}}</div></slide> </carousel>'}}),angular.module("cv").directive("inject",function(){return{link:function(e,t,n,i,r){if(r){var c=e.$new();r(c,function(e){t.empty(),t.append(e),t.on("$destroy",function(){c.$destroy()})})}}}}),angular.module("cv").directive("disableAnimation",["$animate",function(e){return{restrict:"A",link:function(t,n,i){i.$observe("disableAnimation",function(t){e.enabled(!t,n)})}}}])}();
!function(){"use strict";angular.module("cv").factory("cvStructure",[function(){return{cv:{title:"CV",editable:{profilepic:"image"},ordered:!1,api:"api/cv",inherit:{},childs:{cvHeader:"Cv Headers",section:"Sections"},init:{},addableChilds:!1,removable:!1,collapsed:!1},cvHeader:{title:"CV Header",editable:{name:"readOnly",value:"string"},ordered:!1,api:"api/cvheader",inherit:{cv_id:"id"},childs:null,init:{value:"cv header value"},removable:!1},section:{title:"Section",editable:{name:"readOnly"},ordered:!0,api:"api/section",inherit:{cv_id:"id"},childs:{item:"Items"},init:{name:"section title"},addableChilds:!0,removable:!1,collapsed:!0},item:{title:"Item",editable:{name:"string"},ordered:!0,api:"api/item",inherit:{section_id:"id"},childs:{itemHeader:"Item Headers",entry:"Entries"},init:{name:"item title"},addableChilds:!0,removable:!0,collapsed:!0},itemHeader:{title:"Item Header",editable:{name:"string",value:"string"},ordered:!0,api:"api/itemheader",inherit:{item_id:"id"},childs:null,init:{name:"header name",value:"header value"},removable:!0},entry:{title:"Entry",editable:{entry:"textarea"},ordered:!0,api:"api/entry",inherit:{item_id:"id"},childs:{image:"Images"},init:{entry:"text"},addableChilds:!0,removable:!0,collapsed:!1},image:{title:"Image",editable:{description:"string",image:"image"},ordered:!0,api:"api/image",inherit:{entry_id:"id"},childs:null,init:{description:"description"},removable:!0}}}])}();
!function(){"use strict";angular.module("utils",[]).directive("ngAutoExpand",function(){return{restrict:"A",scope:{maxHeight:"@"},link:function(t,i,e){i.bind("keyup",function(t){var i=t.target;$(i).height(0);var e=$(i)[0].scrollHeight;20>e&&(e=28),$(i).height(e-8)}),setTimeout(function(){var t=i;$(t).height(0);var e=$(t)[0].scrollHeight;20>e&&(e=28),$(t).height(e-8)},0)}}})}();
!function(){"use strict";angular.module("cv").controller("ElementController",["$scope","cvFactory","$timeout",function(e,t,n){"true"===e.init&&(e.element=e.$parent.$parent.cv.element),e.onBlur=function(t){e.element.changed&&(e.element.changed=!1,e.element.update())},e.destroy=function(){e.element.destroy()}}])}();
!function(){"use strict";angular.module("cv").directive("cvElement",function(){return{restrict:"E",controller:"ElementController",controllerAs:"element",scope:{element:"=",init:"@"},templateUrl:"dist/templates/cv/edit/cvElement.html"}})}();
!function(){"use strict";angular.module("cv").controller("EditController",["$scope","$anchorScroll","$cvId",function(n,e,o){n.cvId=o,n.sideMenu={show:!1,menu:"structure"},n.openMenu=function(o){n.sideMenu.menu=o,n.sideMenu.show=!0,e("top")}}])}();